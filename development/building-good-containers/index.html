<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Building Good Containers | Node.JS Reference Architecture</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://nodeshift.dev/nodejs-reference-architecture/development/building-good-containers"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Building Good Containers | Node.JS Reference Architecture"><meta data-react-helmet="true" name="description" content="There are a number of recommendations based on our experience building"><meta data-react-helmet="true" property="og:description" content="There are a number of recommendations based on our experience building"><link data-react-helmet="true" rel="shortcut icon" href="/nodejs-reference-architecture/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://nodeshift.dev/nodejs-reference-architecture/development/building-good-containers"><link data-react-helmet="true" rel="alternate" href="https://nodeshift.dev/nodejs-reference-architecture/development/building-good-containers" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://nodeshift.dev/nodejs-reference-architecture/development/building-good-containers" hreflang="x-default"><link rel="stylesheet" href="/nodejs-reference-architecture/assets/css/styles.c2e2bee9.css">
<link rel="preload" href="/nodejs-reference-architecture/assets/js/runtime~main.509bdb81.js" as="script">
<link rel="preload" href="/nodejs-reference-architecture/assets/js/main.8ac72c68.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/nodejs-reference-architecture/"></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/nodejs-reference-architecture/">Node.js Reference Architecture</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Development</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/nodejs-reference-architecture/development/building-good-containers">Building Good Containers</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/development/code-consistency">Code Consistency</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/development/npm-proxy">Npm Proxy / Internal Registry</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/development/npm-publishing">Npm Publishing Guidelines</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/development/testing">Testing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/development/typescript">Typescript</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/development/code-coverage">Code Coverage</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#">Functional components</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/apifirst">REST APIs Development</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/auth">Authentication</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/data-caching">Data Caching</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/databases">Databases</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/graphql">GraphQL Development</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/internationalization">Internationalization</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/message-queuing">Message Queuing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/nodejs-versions-images">Node.js Versions and Container Images</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/scaling-multi-threading">Scaling and Multi-threading</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/static-assets">Static assets</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/template-engines">Template Engines (Server Side)</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/functional-components/webframework">Web Framework</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist" href="#">Operations</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/operations/distributed-tracing">Distributed Tracing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/operations/failurehandling">Fault Tolerance</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/operations/healthchecks">Health Checks</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/operations/logging">Logging</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/nodejs-reference-architecture/operations/metrics">Metrics</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Building Good Containers</h1></header><p>There are a number of recommendations based on our experience building
Node.js applications in containers for deployments:</p><ul><li>build non-root containers</li><li>avoid reserved/privileged ports (i.e. 1-1023)</li><li>use multi-stage builds</li><li>add key tools for problem determination</li><li>use a process manager</li><li>setting memory limits</li><li>avoiding using <code>npm</code> to start application</li><li>tooling for building containers</li></ul><p>This section relies of you having already chosen the base images to
start with. For recommendations on base images check out
<a href="https://github.com/nodeshift/nodejs-reference-architecture/blob/main/docs/functional-components/nodejs-versions-images.md#container-images" target="_blank" rel="noopener noreferrer">Node.js Versions and Container Images - Container images</a>
and <a href="https://github.com/nodeshift/nodejs-reference-architecture/blob/main/docs/functional-components/nodejs-versions-images.md#commercially-supported-containers" target="_blank" rel="noopener noreferrer">Node.js Versions and Container Images - Commercially Supported Containers</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="build-non-root-containers"></a>Build non-root containers<a class="hash-link" href="#build-non-root-containers" title="Direct link to heading">#</a></h2><p>Running processes as root, even in containers can be a security risk,
particularly if external resources are mapped into the container.
The following is a good article which explains why:
<a href="https://medium.com/@mccode/processes-in-containers-should-not-run-as-root-2feae3f0df3b#:~:text=Containers%20are%20not%20trust%20boundaries,a%20container%20on%20your%20server" target="_blank" rel="noopener noreferrer">Processes In Containers Should Not Run As Root</a></p><p>There are also systems which support running containers as <code>rootless</code>.
In order to ensure that your containers can run on these system you
want to avoid running process as root as they may end up depending
on capabilities that are not available when they are run <code>rootless</code>.</p><p>When using docker/podman you can change the user with the <code>USER</code> command.
Well designed base containers will have already done this, but you should
always check what user will be used by default.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token environment constant" style="color:rgb(189, 147, 249)">USER</span><span class="token plain"> </span><span class="token number">1001</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY --chown</span><span class="token operator">=</span><span class="token number">1001</span><span class="token plain">:0 </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It is recommended that you run processes as <code>non-root</code> inside your containers.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="avoid-using-trusted-ports"></a>Avoid using trusted ports<a class="hash-link" href="#avoid-using-trusted-ports" title="Direct link to heading">#</a></h2><p>Ports below 1024 are considered <code>trusted</code> and a process must have
additional priviledges to be able to bind to them.</p><p>If you respect the recommendation to build your containers as
<code>non-root</code> then your process will not be able to bind to the
trusted ports.</p><p>Further, although there are ways to set capabilities on the
container to allow non root users to bind to these ports, at
the time of this writing doing so may cause other problems such
as not being able use the <code>NODE_EXTRA_CA_CERTS</code> environment
variable. You can read more about the issue
<a href="https://github.com/nodejs/node/pull/37727" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Typical work arounds which include using firewall functionality to
proxy ports most often don&#x27;t work in containers as the firewall
capability is often not included in container distributions.</p><p>It is recommended that you build your containers so that internally
only ports 1024 and above are used.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="use-multi-stage-builds"></a>Use multi-stage builds<a class="hash-link" href="#use-multi-stage-builds" title="Direct link to heading">#</a></h2><p>While layering can reduce the size of the layer that contains
your Node.js application, the total size of all of the layers
for a container still ends up being a concern. This is
particularly true in Kubernetes environments where Pods and
Nodes may come/go frequently and the case were all layers
need to be installed is more common than might be expected.</p><p>Best practice is to use a two stage build where a larger
build image is used to build an application and then the
resulting artifacts are copied to a run image. The build
image includes all of the tools needed to build the application
(compilers etc.) while the run image only includes what&#x27;s
needed for the application to run. The size difference
between the build and run images can often be significant.</p><p>There are different ways to build containers but most
will support using a build and run image. You read more
about a few examples in these references:</p><ul><li><a href="https://docs.docker.com/develop/develop-images/multistage-build/" target="_blank" rel="noopener noreferrer">multistage-build</a></li><li><a href="https://developers.redhat.com/blog/2018/10/23/modern-web-applications-on-openshift-part-2-using-chained-builds" target="_blank" rel="noopener noreferrer">Modern web applications on OpenShift: Part 2 -- Using chained builds</a></li></ul><p>It is recommended that you use multi-stage builds to minimize
container size.</p><p>When using multi-stage builds there are two additional
techniques which can make your build/development process
more efficient:</p><ul><li>using <code>.dockerignore</code></li><li>image layering</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="using-dockerignore"></a>using <code>.dockerignore</code><a class="hash-link" href="#using-dockerignore" title="Direct link to heading">#</a></h3><p>You might wonder why <code>.dockerignore</code> would be useful if
you have a multistage build and only <code>COPY</code> the required
artifacts into the deployment image. In this case it is
not about keeping the final image size small, but instead
avoiding slowing down copies into the initial build
image.</p><p>As an example, it&#x27;s common to run npm install locally
to validate the package.json or test locally. If you do
that a COPY command which would normally copy over only
the files required to build (ex <code>COPY --chown=1001:0 . .</code>)
will end up copying the <code>node_modules</code> directory, and
taking a lot longer.</p><p>It&#x27;s recommended that you use a <code>.dockerignore</code> file
which at a minium includes:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">node_modules</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.git</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.cache</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="dependency-image"></a>dependency image<a class="hash-link" href="#dependency-image" title="Direct link to heading">#</a></h3><p>The dependencies for your application likely change
less often than the code for your application. This
means that if you build/install your depdencies and
application in the same step you&#x27;ll end up building/installing
the depdencies even when they have not changed. Couple
that will the fact that it often takes much longer
to build/install the depdencies than the application
and the result is that your build will likely take
longer than needed.</p><p>In order to optimize your build times it is often useful
to build a dependency image. The creation of the
dependency image builds/installs the appliation dependencies
to create a new image (often this is just npm install). Each
time you change your application you then build on top of
that dependency image which can often just be a <code>COPY</code>
of JavaScript and other static files into the
dependency image.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="add-key-tools-for-problem-determination"></a>Add key tools for problem determination<a class="hash-link" href="#add-key-tools-for-problem-determination" title="Direct link to heading">#</a></h2><p>It can be difficult to add tooling/packages after the fact when
issues are identified in production. Plan how you will
investigate problems reported in production and include tooling
in your containers in order to support problem determination
workflows.</p><p>This may increase the size of your containers but is worth
the increase in size based on our experience.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="use-a-process-manager"></a>Use a process manager<a class="hash-link" href="#use-a-process-manager" title="Direct link to heading">#</a></h2><p>The Node.js and npm processes do not expect to run as PID 1
which is the case when run in a container. There are
special expectations for the process run as PID 1 including
reaping zombies and not meeting these expectations can lead
to problems. You can read about the issue in:
<a href="https://blog.phusion.nl/2015/01/20/docker-and-the-pid-1-zombie-reaping-problem/" target="_blank" rel="noopener noreferrer">docker-and-the-pid-1-zombie-reaping-problem</a></p><p><a href="https://github.com/krallin/tini" target="_blank" rel="noopener noreferrer">Tini</a> is a process manager some of our teams have
used successefully.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="manage-scaling-outside-of-the-container"></a>Manage scaling outside of the container<a class="hash-link" href="#manage-scaling-outside-of-the-container" title="Direct link to heading">#</a></h2><p>Avoid using the cluster module and processes managers inside of the
container.</p><p>From our experience it as efficient or more efficient to handle
scaling outside of the container and ensures the layer with the
best information can scale your application when needed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="setting-memory-limits"></a>setting memory limits<a class="hash-link" href="#setting-memory-limits" title="Direct link to heading">#</a></h2><p>The Node.js runtime sets default memory limits for the heap which may not
match what you want to use in production.</p><p>Use an environment variable in your start scripts so that you can
tell the Node.js runtime in the container to use a limit which matches
the amount of memory you will provide to the container when it is run.</p><p>The following is an example of doing so in the start script within
<code>package.json</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">&quot;start&quot;</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;if [ -z </span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MAX_NODE_MEMORY</span><span class="token string entity" style="color:rgb(255, 121, 198)">\&quot;</span><span class="token string" style="color:rgb(255, 121, 198)"> ]; then export MAX_NODE_MEMORY=2048; fi; node --max-old-space-size=</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$MAX_NODE_MEMORY</span><span class="token string" style="color:rgb(255, 121, 198)"> bin/app.js&quot;</span><span class="token plain">,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will then allow you to conifgure the <code>max-old-space-size</code> to
align with what you define in your kubernetes deployment files or
set withe the --memory option in docker run commands.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="avoiding-using-npm-to-start-application"></a>avoiding using <code>npm</code> to start application<a class="hash-link" href="#avoiding-using-npm-to-start-application" title="Direct link to heading">#</a></h2><p>While you will often see <code>CMD [&quot;npm&quot;, &quot;start&quot;]</code> in docker files
used to build Node.js applications there are a number
of good reasons to avoid this:</p><ul><li>One less component. You generally don&#x27;t need <code>npm</code> to start
your application. If you avoid using it in the container
then you will not be exposed to any security vulnerabilities
that might exist in that component or its dependencies.</li><li>One less process. Instead of running 2 process (npm and node)
you will only run 1.</li><li>There can be issues with signals and child processes. You
can read more about that in the Node.js docker best practices
<a href="https://github.com/nodejs/docker-node/blob/main/docs/BestPractices.md#cmd" target="_blank" rel="noopener noreferrer">CMD</a>.</li></ul><p>Instead use a command like <code>CMD [&quot;node&quot;,&quot;index.js&quot;]</code>,</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="tooling-for-building-containers"></a>tooling for building containers<a class="hash-link" href="#tooling-for-building-containers" title="Direct link to heading">#</a></h2><p>When containers where first introduced the only way to build
and run them was with <code>docker</code>. Depending on the operating
system you are running on, there may be other options which
provide advantages and are worth considering. You can
read more about some of these in
<a href="https://developers.redhat.com/blog/2019/02/21/podman-and-buildah-for-docker-users#what_is_buildah_and_why_would_i_use_it_-h2" target="_blank" rel="noopener noreferrer">Podman and Buildah for Docker users</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/nodeshift/nodejs-reference-architecture/docs/development/building-good-containers.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/nodejs-reference-architecture/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Node.js Reference Architecture</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/nodejs-reference-architecture/development/code-consistency"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Code Consistency Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#build-non-root-containers" class="table-of-contents__link">Build non-root containers</a></li><li><a href="#avoid-using-trusted-ports" class="table-of-contents__link">Avoid using trusted ports</a></li><li><a href="#use-multi-stage-builds" class="table-of-contents__link">Use multi-stage builds</a><ul><li><a href="#using-dockerignore" class="table-of-contents__link">using <code>.dockerignore</code></a></li><li><a href="#dependency-image" class="table-of-contents__link">dependency image</a></li></ul></li><li><a href="#add-key-tools-for-problem-determination" class="table-of-contents__link">Add key tools for problem determination</a></li><li><a href="#use-a-process-manager" class="table-of-contents__link">Use a process manager</a></li><li><a href="#manage-scaling-outside-of-the-container" class="table-of-contents__link">Manage scaling outside of the container</a></li><li><a href="#setting-memory-limits" class="table-of-contents__link">setting memory limits</a></li><li><a href="#avoiding-using-npm-to-start-application" class="table-of-contents__link">avoiding using <code>npm</code> to start application</a></li><li><a href="#tooling-for-building-containers" class="table-of-contents__link">tooling for building containers</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/nodejs-reference-architecture/assets/js/runtime~main.509bdb81.js"></script>
<script src="/nodejs-reference-architecture/assets/js/main.8ac72c68.js"></script>
</body>
</html>